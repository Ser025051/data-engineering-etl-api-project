#Extraer

import pandas as pd

def extract(file):
    df = pd.read_csv(file)
    return df


def transform(df):
    df = df.dropna()
    df["email"] = df["email"].str.lower()
    return df

#Transformar

def transform(df):
    df = df.dropna()
    df["email"] = df["email"].str.lower()
    return df

#cargar


import os
from sqlalchemy import create_engine
from dotenv import load_dotenv
from extract import extract
from transform import transform

load_dotenv()
DATABASE_URL = os.getenv("DATABASE_URL")
engine = create_engine(DATABASE_URL)

def load_sales():
    df = extract("data/sales.csv")
    df = transform(df)
    df.to_sql("sales", engine, if_exists="append", index=False)
